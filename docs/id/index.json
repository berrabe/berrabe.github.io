[{"content":"Â Â 1) TLDR  tet tet tetttt \u0026hellip; balek lagi sama saya, berrabe \u0026hellip; dimana saya suka memecahkan masalah menjadi masalah lagiii, YEAY ğŸ˜\nokehhh \u0026hellip; saya pengen share lagi caranyooo lari dari kenyataan, ehh ğŸ˜… \u0026hellip;\nfokusss \u0026hellip; maksudnya cara nge-install gitlab-runner, WUHUUU ğŸ˜µ\n âš ï¸ Note : sebelum masuk ke sini, pastikan sudah paham apa itu kultur DevOps, dan istilah-istilah di dalamnya, seperti CI / CD, Pipeline, Build, Deploy, Automation, dll\n Â lanjottt , gitlab-runner itu cemilan apaan sih? \u0026hellip;\nbagi yang belum tau / belum pernah dengar, gitlab-runner merupakan cemilan program yang di gunakan untuk menghandle proses automasi kerja yang terjadi pada pipeline di gitlab CI / CD\ndyarrrr \u0026hellip; mumet to ndase ğŸ˜© ğŸ˜©\nÂ untuk lebih jelasnya lihat gambar di atas, CI PIPELINE dan CD PIPELINE semua nya butuh gitlab-runner\ndimana runner berfungsi sangat penting agar CI / CD pipeline pada gitlab bisa berjalan, jika tidak ada runner yang aktif / terset, maka job di pipeline status nya akan pause dan stuck / tidak bisa jalan\nÂ Â Â 2) Wuuzzzz \u0026hellip;.  okeh, tapi bukannya Gitlab sudah menyediakan runner punya mereka sendiri (shared runner)? , trus kenapa harus install runner punya sendiri?\njawabannya \u0026ldquo;tergantung orangnya\u0026rdquo;, kalo saya install runner sendiri agar proses pipeline bisa lebih cepat di bandingkan shared runner gitlab (namanya juga berbagi) dan untuk alasan keamanan \u0026hellip; yap karna keamanan sangat penting\nwalaupunnnnn shared-runner akan menghapus container saat job selesai, tapi kan kita tidak bisa menjamin 100%, apalagi jika code di repo sangat private dan ada beberapa informasi sensitif di dalamnya (walau bukan best practice)\nhhmmmmm \u0026hellip;. OK, setelah mulut berbusa karna terlalu banyak jelasin, langsung lanjot ae ke praktek setup nya dah ğŸ˜“\nÂ 2.a) Siomay Docker sebagai executor sebelum masuk ke gitlab-runner nya, install executor dulu\nexecutor itu merupakan makanan tools / metode yang di gunakan gitlab-runner untuk mengeksekusi job di pipeline CI / CD nya, untuk list executor bisa lihat di sini \u0026hellip; saya memilih docker biar isolated dan mudah maintenance\n\u0026gt; curl -fsSL https://get.docker.com -o get-docker.sh \u0026gt; sh get-docker.sh \u0026gt; systemctl start docker Â 2.b) Install Gitlab-Runner kebetulan saya install gitlab-runner di Debian dengan spec server 48 Core CPU 128 GB RAM \u0026hellip; kenthirrr ğŸ˜‚ ğŸ˜‚\nbiar gampang maintenance gitlab-runner nantinya, saya install sebagai package repo saja\n\u0026gt; curl -L \u0026#34;https://packages.gitlab.com/install/repositories/runner/gitlab-runner/script.deb.sh\u0026#34; | sudo bash # Pengguna Debian buster harus disable skel untuk mencegah error No such file atau directory Job failures \u0026gt; export GITLAB_RUNNER_DISABLE_SKEL=true; \u0026gt; sudo -E apt install gitlab-runner anddd \u0026hellip; donee, gimana? gampang to \u0026hellip; cuman 3 baris perintah doang ğŸ‘ ğŸ˜\nâš ï¸ Note : spec yang di butuhkan menjalankan gitlab-runner + docker sangat kecil \u0026hellip; semakin tinggi semakin bagus\nÂ 2.c) Register Gitlab-Runner Tahap selanjutnya, Gitlab-Runner harus di daftarkan ke Gitlab, agar nantinya Gitlab bisa kenalan dan menggunakan gitlab-runner di server ini\nsebelum itu, dapetin token untuk runner dan URL nya di settings --\u0026gt; CI / CD --\u0026gt; runners\nlangsung masuk ke CLI, buat daftarin runner di server agar bisa nyambung ke gitlab \u0026hellip;\njangan lupa kalo copas sambil di lihat scriptnya ğŸ˜ , sesuaikan url dan gitlab-runner token nya\n\u0026gt; gitlab-runner register -n \\ --url \u0026lt; URL \u0026gt; \\ --registration-token \u0026lt; GITLAB-RUNNER TOKEN \u0026gt; \\ --executor docker \\ --description \u0026#34;Mantan Jelek\u0026#34; \\ --docker-image \u0026#34;docker:stable\u0026#34; \\ --tag-list mantan-jelek \\ --request-concurrency 30 \\ --limit 30 \\ --docker-privileged kalau uda, nanti di gitlab akan muncul beginian, menandakan kalau runner di server sudah tersambung ke gitlab dan sudah siap di gunakan oleh CI / CD job\nÂ Â Â 3) Mencoba Gitlab-Runner  nah tadi kan uda proses install executor, gitlab-runner sama registrasi nya \u0026hellip; sekarang cara gunain runner nya begimaneeeee ?\nsabarrr \u0026hellip; kasih istirahat otak dulu nape ğŸ˜ª\nÂ 3.a) tagging buat gunain gitlab-runner yang uda di setting tadi, bisa dengan ngasi atribut tags pada file .gitlab-ci.yml di bagian job atribut nya \u0026hellip; contoh nya seperti di bawah di mana tadi saya setting tag runner nya dengan nama mantan-jelek\nbuild: image: docker:latest stage: publish tags: - mantan-jelek services: - docker:dind script: - docker build -t $TAG_COMMIT -t $TAG_LATEST . # push to Gitlab container registry instead of docker hub - docker login -u gitlab-ci-token -p $CI_BUILD_TOKEN $CI_REGISTRY - docker push $TAG_COMMIT - docker push $TAG_LATEST only: # regex for semantic version (vx.x.x) - /^v([0-9]+)\\.([0-9]+)\\.([0-9]+)$/ except: - branches Â 3.b) Untagged Jobs cara yang kedua adalah dengan cara aktifkan mode untagged-jobs \u0026hellip; berguna untuk jobs yang tidak punya / tidak di set tags\nkalau opsi ini tidak di aktifkan, maka status pipeline job akan pause stuck (jika shared runner tidak ada / di nonaktifkan)\nuntuk mengaktifkan, tinggal masuk ke settingan runner yang tadi dan centang seperti di gambar\nâš ï¸ Note : tags di gitlab CI / CD berbeda dengan git tag \u0026hellip; tags di CI / CD di gunakan untuk memilih runner yang di gunakan untuk mengeksekusi job\nÂ Â Â 4) TroubleShoot \u0026quot;Cannot Connect to Docker Daemon\u0026quot;?  akhirnyaaa semua sudah berhasil, tetapi saat proses packaging dari source code menjadi docker image, ada error yang terjadi, dimana executor tidak bisa mengkontak socket dari docker-machine API ğŸ˜± ğŸ˜± \u0026hellip;\ncobaan apa lagi ini gustiiiii ğŸ˜© ğŸ˜© \u0026hellip;.\nsetelah bertapaa selama 5 menit, dapat wangsit petunjuk jugaaa ğŸ˜‚\nternyata cara solve nya sangat mudah, tinggal binding docker.sock volume di runner yang telah di set tadi \u0026hellip; edit file /etc/gitlab-runner/config.toml\n[runners.docker] xxx xxx volumes = [\u0026#34;/cache\u0026#34;] xxx tambahkan docker socket di bagian volumes, menjadi\nvolumes = [\u0026#34;/var/run/docker.sock:/var/run/docker.sock\u0026#34;, \u0026#34;/cache\u0026#34;] dan PIPELINE pun berjalan lancarrrr, YEAY ğŸ˜Œ\nâš ï¸ Note : saat menjalankan command gitlab-runner register, konfigurasi akan otomatis di buat pada dir /etc/gitlab-runner/config.toml\n","permalink":"https://berrabe.github.io/id/posts/2021/05-jan-2021/setup-gitlab-runner-docker-executor/","summary":"1) TLDR  tet tet tetttt \u0026hellip; balek lagi sama saya, berrabe \u0026hellip; dimana saya suka memecahkan masalah menjadi masalah lagiii, YEAY ğŸ˜\nokehhh \u0026hellip; saya pengen share lagi caranyooo lari dari kenyataan, ehh ğŸ˜… \u0026hellip;\nfokusss \u0026hellip; maksudnya cara nge-install gitlab-runner, WUHUUU ğŸ˜µ\n âš ï¸ Note : sebelum masuk ke sini, pastikan sudah paham apa itu kultur DevOps, dan istilah-istilah di dalamnya, seperti CI / CD, Pipeline, Build, Deploy, Automation, dll","title":"Setup Gitlab-Runner + Docker Executor"},{"content":"Â Â 1) TLDR  tet tet tetttt \u0026hellip; balek lagi sama saya, berrabe \u0026hellip; dimana saya suka memecahkan masalah menjadi masalah lagiii, YEAY ğŸ˜\nkali ini saya pengen sharing lagi bagaimana cara memasak indomie, eh \u0026hellip; maap, efek laperrr ğŸ˜ª\nmaksud saya cara Monitoring, Undervolting dan Tweaking CPU di Linux. Untuk info saja, topik utamanya adalah UNDERVOLTING \u0026hellip; dimana dari undervolting itu nyambung ke tweaking lalu monitoring\nsebelumnya uda tau belom ama undervolt? adeknya overclock itu lhooo, anak nya pak RT ğŸ˜Œ \u0026hellip; klo blom, saya kasih tauu \u0026hellip;\nÂ Â Â 2) Adek Kakak?  Penjelasan OverClock dan UnderVolt secara garis besar, biar ga salah paham \u0026hellip; beda kaya jelasin ke doi, selaluuuuu aja salah, hiks hiks ğŸ˜©\nÂ 2.a) OverClocking jadi gini, di dunia per-hardware an ini, ada istilah yang sering kali di ucapkan, baik oleh para gamers, Antusias PC, Editor, dll \u0026hellip; yaitu OVERCLOCKING, dimana overclocking ini akan menaikkan clock dari CPU, misal dari 2 ke 5 GHz dengan syarat dan ketentuan berlaku ğŸ˜\njika clock CPU naik, kecepatan komputasi dari sebuah CPU akan menjadi lebih cepat, jadi semisal, ada editor rendering video 4k 30 detik di clock 2 GHz membutuhkan waktu 15 menit lebih, maka kalau di 5 GHz hanya 5 menit atau kurang\nsangat lumayan bukan? \u0026hellip; brati saya sekarang bisa beli CPU harga 3-4 jutaan yang akan menyaingi CPU harga 6 jutaan ke atas, YEAYY ğŸ˜€\nÂ 2.b) UnderVolting tadi saya sudah menjelaskan OverClocking secara garis besar, sekarang apa itu UndverVolting?\ngampangnya, undervolting itu kebalikan dari overclocking \u0026hellip; jadi, klo overclocking itu Voltase CPU nya di naikkan agar Clock CPU nya bisa naik\nnah klo undervolt, Voltase CPU nya di turunkan, supaya apa? \u0026hellip; bisa banyak, coba lanjut baca dulu, nanti saya suapin, eh \u0026hellip; jelasinnn ğŸ˜‹\nÂ 2.c) Kelebihan dan Kekurangan kelebihan dan kekurangan secara garis besar antara OverClocking dan UnderVolting \u0026hellip; bukan antara kamu dan dia, yhaaa ğŸ˜œ\n   Metric OverClocking UnderVolting     CPU Voltase / Vcore Naik Turun   CPU Clock Naik Tetap / di Turunkan   Suhu CPU Semakin Tinggi Stabil / Semakin Rendah   Performa CPU Naik Tetap / Turun   Listrik Boros Stabil / Hemat   Baterai Boros Irit   Umur CPU Berkurang Awet   Biaya Mahal / Ada Biaya Tanpa Biaya    sudah paham kan gambaran antara OverClocking dan UnderVolting secara umum \u0026hellip; ingat secara umum tujuan dari 2 metode diatas seperti itu, tapi balik lagi ke Tweaker / OverClocker nya\nÂ Â Â 3) UnderVolting!!!  kalau di windows, banyak sekali tools untuk overclocking / undervolting, contoh nya untuk CPU Intel ada ThrottleStop, Intel Xtreme Utility dsb. Untuk AMD Ryzen ada AMD Ryzen Master dsb\ndi linux, hanya ada beberapa yang terkenal dan sering di gunakan, yaitu Python Undervolt \u0026hellip; di buat menggunakan bahasa python, dokumentasi lengkap nya bisa di lihat di sini\nÂ 3.a) Persiapan UnderVolting cara install dan makai nya sangat-sangat gampang, yang di butuhkan adalah\n Python v3.x Python3-pip CPU Intel \u0026gt;= Gen 4 (Haswell) Gebetan ğŸ˜‚  # install undervolt \u0026gt; sudo pip3 install undervolt # testing pembacaan CPU Voltase / Vcore \u0026gt; sudo undervolt --read temperature target: -1 (99C) core: 0.0 mV gpu: 0.0 mV cache: 0.0 mV uncore: 0.0 mV analogio: 0.0 mV powerlimit: 46.25W (short: 0.00244140625s - enabled) / 37.0W (long: 28.0s - enabled) [locked] âš ï¸ Note : Jika proses read gagal, di karenakan tidak semua CPU bisa di undervolt, ada beberapa CPU yang tidak di dukung karna driver CPU nya atau faktor lainnya\nÂ 3.b) Core of The Core Cara UnderVolting itu sangat mudah sekali, seng penting yaqqinnnn ğŸ˜‚\ntapi serius, tidak ada rumus pasti untuk menentukan angka batas / offset, karna setiap CPU itu bisa berbeda walaupun versi / seri nya sama, dan karna saya sudah pernah coba-coba di windows menggunakan aplikasi ThrottleStop dan Intel Extreme Utility, maka angka offset nya tinggal saya aplikasikan di Python Undervolt linux ini\n\u0026gt; sudo undervolt \\ --core -165 \\ --cache -165 \\ --gpu -135 \\ --uncore -165 \\ --analogio -165 \u0026gt; sudo undervolt --read temperature target: -1 (99C) core: -165.04 mV gpu: -134.77 mV cache: -165.04 mV uncore: -165.04 mV analogio: -165.04 mV powerlimit: 46.25W (short: 0.00244140625s - enabled) / 37.0W (long: 28.0s - enabled) [locked] sudah selesaiii \u0026hellip; gampang kann??? kalo ada yang bilang susah, harus di ruqyah tu kayaknyaaa ğŸ˜¤\nÂ Â Â 4) Monitoring Mantan  woke sekarang saatnya monitoring Mantan CPU nya, di sini saya membuat tools nya sendiri \u0026hellip; bisa di lihat di sini\nÂ 4.a) Installing Mantan sekali lagi, cara install dan pakai nya sangat mudah, pastikan package lm_sensors dan git sudah terinstall\n# Install Package Pendukung \u0026gt; sudo pacman -S lm_sensors git # Install CPU-UTIL \u0026gt; git clone https://github.com/berrabe/cpu-util.git \u0026gt; cd cpu-util \u0026gt; sudo cp cpu-util /usr/bin/ âš ï¸ Note : FYI untuk cpu-util ini bukan hanya untuk monitoring, tapi bisa untuk scaling frequency dan non-aktifkan multi-threading + booster \u0026hellip;\nÂ 4.b) CPU Freq Scaling Scaling CPU Frequency ini tidak wajib, tapi saya selalu menggunakannya agar hasil UnderVolt lebih maksimal\n\u0026gt; cpu-util -sf 1000000 Core 0 =\u0026gt; 1,000,000 MHz Core 1 =\u0026gt; 1,000,000 MHz Core 2 =\u0026gt; 1,000,000 MHz Core 3 =\u0026gt; 1,000,000 MHz Core 4 =\u0026gt; 1,000,000 MHz Core 5 =\u0026gt; 1,000,000 MHz Core 6 =\u0026gt; 1,000,000 MHz Core 7 =\u0026gt; 1,000,000 MHz âš ï¸ Note : Semakin Rendah CPU Frequency, maka nilai offset undervolt juga bisa di rendahkan \u0026hellip; semisal di angka 2.5 GHz sebesar -100 mV, maka setelah di UnderClock ke 800 MHz bisa di set ke -150 mV\nÂ 4.c) Keadaan Mantan CPU? oke, saatnya menjalankan mode monitoring\n\u0026gt; cpu-util -mo [ Monitoring ] [ 15:16:18 ] [+] OS Info | |-[+] Proc Intel(R) Core(TM) i7-4702MQ CPU @ 2.20GHz |-[+] Uptime 5 hours, 1 minute |-[+] Host Lenovo IdeaPad Z410 |-[+] Kernel 5.4.85-1-MANJARO |-[+] Arch Manjaro Linux x86-64 [+] Sys Info | |-[+] cpu 6.11 % |-[+] Driver intel_pstate |-[+] Gov performance - powersave |-[+] Mem 2197 MB / 5701 MB |-[+] Core 8 / 8 Cores |-[+] Stats 976.873 MHz 39.0 Â°C 984.844 MHz 39.0 Â°C 997.397 MHz 37.0 Â°C 997.473 MHz 39.0 Â°C 997.428 MHz 985.895 MHz 997.461 MHz 989.919 MHz sudah terlihat, informasi basic dari linux saya dan prosesor nya \u0026hellip; dan bisa di lihat juga suhu prosesor saya, rerata hanya 39.0 Â°C !! \u0026hellip;\nini posisi intel i7 yang haus power, dan posisi lagi buka banyak tab firefox bejibun (lihat penggunaan ram), Ngetik, Coding, Dengerin Spotify dsb\nUnderVolting itu Worth It Bukan?\nÂ Â Â 5) CPU Jadul / Non-Intel?  oke, semua hasil sudah terlihat, dan menurut saya UnderVolt itu sangat worth it \u0026hellip; karna banyak maanfaatnya, paling kerasa di suhu CPU, penggunaan baterai dan nantinya berimbas ke keawetan CPU itu sendiri ğŸ˜\ntapi masalahnya metode ini hanya berlaku untuk intel generasi terbaru \u0026gt;= Gen 4 / Haswell, tapi bagaimana jika intel di bawah Gen 4 atau CPU AMD?\n Intel Di Bawah Gen 4  saya dulu pernah mencoba pada prosesor Intel Core 2 Duo di laptop VAIO VGN-Z46GD tahun 2008 menggunakan Intel PHC, bisa di lihat di sini. dengan driver CPU lama acpi_cpufreq di bandingkan yang sekarang Intel P-states\ntapi menurut saya, Intel PHC tidak cukup powerful karna tidak bisa melakukan UnderVolting di bawah 0 mV (offset tidak bisa minus), sehingga hasil nya terasa kurang maksimal\n Processor AMD  untuk processor AMD jujur saja saya belum pernah coba, tapi bila membaca dokumentasi dari tools Python3 Undervolt dan Intel PHC. tools-tools ini bisa melakukan nya dengan lancar tanpa ada kendala, syarat dan ketentuan berlaku ğŸ˜Š\n","permalink":"https://berrabe.github.io/id/posts/2021/04-jan-2021/monitoring-undervolting-and-tweaking-cpu-on-top-linux/","summary":"1) TLDR  tet tet tetttt \u0026hellip; balek lagi sama saya, berrabe \u0026hellip; dimana saya suka memecahkan masalah menjadi masalah lagiii, YEAY ğŸ˜\nkali ini saya pengen sharing lagi bagaimana cara memasak indomie, eh \u0026hellip; maap, efek laperrr ğŸ˜ª\nmaksud saya cara Monitoring, Undervolting dan Tweaking CPU di Linux. Untuk info saja, topik utamanya adalah UNDERVOLTING \u0026hellip; dimana dari undervolting itu nyambung ke tweaking lalu monitoring\nsebelumnya uda tau belom ama undervolt?","title":"Monitoring, Undervolting and Tweaking CPU on Top Linux"},{"content":"Â Â 1) TLDR  tet tet tetttt \u0026hellip; balek lagi sama saya, berrabe \u0026hellip; dimana saya suka memecahkan masalah menjadi masalah lagiii, YEAY ğŸ˜\nkali ini saya pengen sharing dikit \u0026hellip; suatu hari, saya di suruh ganti password server + setting SSH-Key yang akan di lakukan rutin setiap bulan, untuk alasan keamanan\nmasih oke lahhhh, ganti gitu doanggg ğŸ˜™ \u0026hellip;\neits, tapi masih belum selesai, ternyata server nya kagak cuman atuu, tapi puluhan server \u0026hellip; WHAT!?, lebih tepat nya 40 server per bulan ini yang akan bertambah lagi seiring pertambahan client\nFYI, beberapa block server di tempatkan pada DC (Data Center) yang berbeda dengan kebijkan firewall berbeda pula, dan tidak semua server punya IP PUBLIC \u0026hellip; MAMPOSSSHHHH ğŸ˜±\nmulai mikir nih, klo ganti manual tangan saya tekor kaga yak, dan butuh berapa lama? belum lagi klo kagak berhasil karna beberapa faktor, seperti human error\ndan di tambah lagi, semua ini di lakukan perbulan!! ğŸ˜­\nÂ Â Â 2) Mencari Solusi Tanpa Solusi ğŸ˜…  okeh .. singkat cerita akhirnya saya nemu makanan namanya Ansible \u0026hellip; eh bukan makanan deng, tapi tools ğŸ˜…\nkarna tadi ngobrol ama ansible nya cuman bentar, jadi saya crita tentang doi dikit aje ye, selebihnya bisa cari di dokumentasi, artikel, dll \u0026hellip;\nsingkatnya, doi merupakan tools yang di gunakan untuk meng-automasi kerjaan kita terkait maintenance hardware di IT (Server, Router, Switch, dll)\nautomasi nya kek mana? yaaaa seperti ganti password, konfigurasi server / router, deploy script dll \u0026hellip; pokoknya semua hal yang kita lakukan secara manual menggunakan CLI (Command Line Interface) lewat SSH (Secure Shell) bisa di lakukan ama doi secara otomatis \u0026hellip; aji gile, gokil benerrr ğŸ˜µ\nÂ Â Â 3) Syarat Untuk nikah Memakai?  Syarat untuk memakai si Ansible sangat mudah, yang penting punya:\n Laptop / Komputer SSH + SSH-Key Python v2.x / v3.x VPN PACAR  laptop / komputer itu sebagai \u0026ldquo;OTAK\u0026rdquo; yang akan mengatur semua server-server tadi .. kebetulan server-server yang akan saya remote basis nya CentOS dan Debian, jadi semua sudah otomatis terinstall SSH dan Python v2.x secara default\nsoooo, saya hanya butuh install Ansible aja sebagai \u0026ldquo;OTAK\u0026rdquo; di LAPTOP Saya\nFYI, di karenakan server-server ini berbeda tempat + berbeda password, maka saya login atu-atu dulu ke semua server buat nyetting SSH-Key punya saya, biar klo login kaga usah ngetik password + saya juga setting VPN, tepatnya OpenVPN di setiap server, agar konek nya gampang, dan maintenance list server nya mudah (satu network)\nÂ Â Â 4) Caranya?  okehh, lanjottt ke cara make si Ansible nya kek manaaa? \u0026hellip; sabar sodara-sodara, mikir kalimat nya dulu ini, emang gampang apa nulis beginian ğŸ˜‘\nÂ 4.a) Install si Otak Karna Laptop saya menggunakan Linux (Arch-Based), maka cara install nya tinggal pakai paket manager saja \u0026hellip; untuk yang tidak sama, bisa ikutin caranyee di dokumentasi resminya\n\u0026gt; pacman -S ansible Â 4.b) Konfigurasi Masuk ke tahap konfig, mari kita buat simple\n\u0026gt; mkdir skidipapap \u0026gt; cd skidipapap \u0026gt; touch hosts.yml \u0026amp;\u0026amp; touch 01-passwd.yml Â 4.b.I) Konfigurasi - hosts Nah, kan saya mau automasi ke server-server nih, saya harus ngasih tau dulu si Ansible, server nya yang mane ajee \u0026hellip; kan doi belum pernah kenalan, kesian ntar malah salah masuk server, kan jadi berrabe\nisi ke file hosts.yml seperti di bawah, ganti x.x.x.x menjadi ip server\n--- all: hosts: x.x.x.x x.x.x.x x.x.x.x # dst vars: ansible_user: root ansible_python_interpreter: /usr/bin/python Â 4.b.I) Konfigurasi - Otak Oke, sekarang bagian terpenting, saya akan setting logic automasi nya \u0026hellip; isi ke file 01-passwd.yml\n--- - name: CHANGE PASSWORD ALL SERVER hosts: \u0026#39;all\u0026#39; gather_facts: no tasks: - name: PING ping: - name: SET / DELETE SSH-KEY WITH BLOCK blockinfile: path: /root/.ssh/authorized_keys state: present marker: \u0026#34;# {mark} SSH Public Key, reset every month | DO NOT DELETE THIS BLOCK !!!\u0026#34; block: \u0026#34;{{ lookup(\u0026#39;file\u0026#39;, \u0026#39;$HOME/.ssh/authorized_keys\u0026#39;) }}\u0026#34; # block: \u0026#34;ssh-rsa xxxxxxxxx ...\u0026#34; - name: CHANGE ROOT PASSWORD user: name: root update_password: always password: \u0026#34;{{ password|password_hash(\u0026#39;sha512\u0026#39;) }}\u0026#34; FYI, jika setting manual biasanya menggunakan command CLI Linux, di Ansible berbeda \u0026hellip;\nAnsible menggunakan module yang isinya berupa script python (makanya server butuh terinstall python), yang akan di kirimkan dari si OTAK (Client) ke server-server \u0026hellip; jika sudah di kirimkan, script python tadi akan di eksekusi\ntiap module berbeda cara penggunaan, tinggal baca dokumentasi terkait module apa yang akan di gunakan (misal modul user untuk membuat / mengganti / menghapus informasi suatu user di Linux)\nÂ 4.c) Ngengggg \u0026hellip; wokai, gampang kan konfigurasi nya? langkah terakhir yaitu jalanin si ansible ini \u0026hellip; cukup 1 baris perintah\n\u0026gt; ansible-playbook 01-passwd.yml -e \u0026#39;password=berrabe_ganteng\u0026#39; -i hosts-yml -f 40 Â Â Â 4) Kesimpulan  huahhhh \u0026hellip; setelah 5 menit konfig ansible + 3 jam setting ssh-key, setting vpn, tshoot di puluhan server \u0026hellip; selesai juga ni kerjaan ğŸ’ª\nhasilnya akan seperti ini\nPLAY [CHANGE PASSWORD ALL SERVER] TASK [PING] ok: [x.x.x.x] ok: [x.x.x.x] ok: [x.x.x.x] TASK [SET / DELETE SSH-KEY WITH BLOCK] changed: [x.x.x.x] changed: [x.x.x.x] changed: [x.x.x.x] TASK [CHANGE ROOT PASSWORD] changed: [x.x.x.x] changed: [x.x.x.x] changed: [x.x.x.x] PLAY RECAP x.x.x.x : ok=3 changed=2 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 x.x.x.x : ok=3 changed=2 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 x.x.x.x : ok=3 changed=2 unreachable=0 failed=0 skipped=0 rescued=0 ignored=0 hhmmm, gampang kan?\nBTW, saya konfigurasi manual untuk ganti password, setup ssh-key dan troubleshoot nya BUTUH 3 JAM AN \u0026hellip; belum ditambah ama kepala pusing, mata merah, laper, ngantuk, leher pegel, ga punya pacar, eh \u0026hellip; dan ini akan terulang setiap bulan, pfttt ğŸ˜ª\ndan coba bandingkan menggunakan Ansible, dengan kemudahan yang doi punya, hanya butuh 5 - 30 menit untuk konfigurasi, tinggal search module nya apa (misalkan user dan blockinfile), saya bisa ganti password + setting SSH-Key dalam waktu 5 menit ke puluhan server\njadi saya tidak perlu lagi meluangkan waktu 3 jam an setiap bulan hanya untuk konfigurasi server perihal pergantian password dan setup SSH-Key. ğŸ˜\n","permalink":"https://berrabe.github.io/id/posts/2021/03-jan-2021/automation-for-changing-server-password-and-setup-ssh-key-to-dozens-of-servers/","summary":"1) TLDR  tet tet tetttt \u0026hellip; balek lagi sama saya, berrabe \u0026hellip; dimana saya suka memecahkan masalah menjadi masalah lagiii, YEAY ğŸ˜\nkali ini saya pengen sharing dikit \u0026hellip; suatu hari, saya di suruh ganti password server + setting SSH-Key yang akan di lakukan rutin setiap bulan, untuk alasan keamanan\nmasih oke lahhhh, ganti gitu doanggg ğŸ˜™ \u0026hellip;\neits, tapi masih belum selesai, ternyata server nya kagak cuman atuu, tapi puluhan server \u0026hellip; WHAT!","title":"Automation For Changing Server Password and Setup SSH-Key to Dozens Of Servers"},{"content":"Â Â 1) TLDR  yo yo yo eee teammm \u0026hellip; welcome bek to my webseettt ğŸ˜§ \u0026hellip; selamat pagi, siang atau malam buat temen2, om, tante, pakdhe, budhe, simbah kakung, simbah putri dan semuanya dah ğŸ˜ª\nkali ini saya akan mendokumentasikan gimaneee caranyee setting banyak openvpn dalam satu server.\nMungkin kalian pernah berfikir untuk bypass limitasi yang di lakukan oleh pihak Vendor / ISP kan? semisal Vendor / ISP kalian tidak bisa buka reddit, netplik, skidipapap huahuahua, dsb. sudah coba pakai OpenVPN default (port 1194/UDP) malah ndak bisa connect juga OpenVPN nya (Vendor Kampret)\natau kalian punya server di Data Center yang Vendor Internetnya mem-block semua port dan protokol default VPN?\noke oke, seperti biasaaa \u0026hellip; jangan tenang dan tetap panik ğŸ˜™ karna kita akan bahas caranye, cekidot\nÂ Â Â 2) Setting Dan Install OpenVPN (Mau Ribet / Engga?)  pastinya ni ye, sebelum gunain OpenVPN Client, pasti harus punya OpenVPN Server nya dulu. Untuk itu saya nawarin nih.\nmau yang cara install nya gampang ape susah, kalau gampang, silahkan gunakan script otomasi seperti dari bang angristan atau dari bang Nyr. Atau mau yang susah / install sendiri dari awal, bisa di cari sendiri tutor nya di google, ade bejibun, biasanya dari DigitalOcean \u0026hellip; sampe bilang kaga ada gw jitak lu ğŸ˜‡\nkebetulan saya pakai punya nya bang angristan (Fork dari Nyr), karna lebih mudah aje gitu, tinggal enter2, ikutin settingan default \u0026hellip; kalau internet server nya cepet, 5 menit selesai dan bisa langsung di pakai (lebih lengkap nya lihat dokumentasi github angristan OpenVPN)\n pastikan akfitkan port forwarding / DMZ jika OpenVPN server di bawah jaringan NAT\n Â Â Â 3) Caranya Multiple Port / Protokol?  Wokehh, setelah installasi OpenVPN server yang saya yakin uda pada bisa, tinggal ikutin tutorial doang, copy / paste beres, tutorial pakai bahasa inggris? tinggal translate ğŸ˜ƒ\nkita akan lanjutkan bagaimana caranya buat multiple ports dan protokol, saya menggunakan script angristan, jika tidak sama bisa di sesuaikan karna tidak beda jauh\nÂ 3.a) Konfigurasi OpenVPN Server sebagai contoh, saya akan buat server OpenVPN baru di port 443/TCP dari settingan default angristan (1194/UDP). Login ke OpenVPN Server menggunakaan SSH\n copy / duplicate server.conf di folder /etc/openvpn/  \u0026gt; cd /etc/openvpn \u0026gt; ls | grep -E \u0026#34;server.*.conf$\u0026#34; -rw-r--r-- 1 root root 696 Dec 17 07:27 server.conf \u0026gt; cp server.conf server_tcp.conf edit file server_tcp.conf, sesuaikan seperti di bawah  # setting port, protokol port 443 proto tcp # setting Network OpenVPN Server server 172.16.111.0 255.255.255.0 # non-aktifkan static ip # ifconfig-pool-persist ipp.txt # setting log file untuk mode 443/TCP status /var/log/openvpn/status_tcp.log tambahkan rule masqurade agar network OpenVPN (172.16.111.x/24) dapat akses ke internet (interface eth0 / WAN)  iptables -t nat -A POSTROUTING -s 172.16.111.0/24 -o eth0 -j MASQUERADE Buat Config untuk Client, terserah namanya apa, format xxx.ovpn dan aktifkan OpenVPN server TCP tadi  \u0026gt; ./openvpn-install.sh \u0026gt; systemctl start openvpn@server_tcp \u0026gt; systemctl enable openvpn@server_tcp Â 3.a) Konfigurasi OpenVPN Client karna multi ports dan protkol tidak di dukung secara default oleh script angristan, maka saya akan modifikasi config auto-generated dari file openvpn-install.sh yang sudah di buat pada point 4 di atas\n pertama edit config file xxx.ovpn, ganti 4 baris teratas menjadi seperti di bawah  client proto tcp # explicit-exit-notify remote \u0026lt;ip openvpn server\u0026gt; 443 pindah xxx.ovpn ke client dan jalankan filenya  \u0026gt; sudo openvpn xxx.ovpn 2021-01-05 12:54:48 OPTIONS IMPORT: adjusting link_mtu to 1626 2021-01-05 12:54:48 OPTIONS IMPORT: data channel crypto options modified 2021-01-05 12:54:48 Outgoing Data Channel: Cipher \u0026#39;AES-128-GCM\u0026#39; initialized with 128 bit key 2021-01-05 12:54:48 Incoming Data Channel: Cipher \u0026#39;AES-128-GCM\u0026#39; initialized with 128 bit key 2021-01-05 12:54:48 TUN/TAP device tun0 opened 2021-01-05 12:54:48 net_iface_mtu_set: mtu 1500 for tun0 2021-01-05 12:54:48 net_iface_up: set tun0 up 2021-01-05 12:54:48 net_addr_v4_add: 172.16.111.2/24 dev tun0 2021-01-05 12:54:48 Initialization Sequence Completed  OpenVPN sudah berhasil connect ke OpenVPN server dengan protokol TCP port 443\n jika sudah berhasil, bisa kita buat service agar jalan secara otomatis  \u0026gt; cp xxx.ovpn /etc/openvpn/client/xxx.conf \u0026gt; sudo systemctl start openvpn-client@xxx \u0026gt; sudo systemctl enable openvpn-client@xxx Â Â Â 4) Terakhir  Gimane, simpel kan? cuman modifikasi beberapa baris aja dari config default bang angristan aja uda bisa setup OpenVPN server Multiple Port dan Protokol.\nGa cuman 2 OpenVPN Server doang, tapi bisa ratusan ğŸ˜‚, yang penting port nya cukup dan ga susah maintenance nantinya.\nUntuk port TCP/443 merupakan port teraman, karna port ini di gunakan oleh sejuta umat untuk akses website HTTPS \u0026hellip; di jamin Vendor tidak akan blocking ğŸ˜‹ bakal di amuk se RW entar \u0026hellip; kalaupun di block secara analisis packet data, kaga bisa, kan di encrypt ğŸ˜‚\n","permalink":"https://berrabe.github.io/id/posts/2021/02-jan-2021/openvpn-multiple-ports-and-protocol/","summary":"1) TLDR  yo yo yo eee teammm \u0026hellip; welcome bek to my webseettt ğŸ˜§ \u0026hellip; selamat pagi, siang atau malam buat temen2, om, tante, pakdhe, budhe, simbah kakung, simbah putri dan semuanya dah ğŸ˜ª\nkali ini saya akan mendokumentasikan gimaneee caranyee setting banyak openvpn dalam satu server.\nMungkin kalian pernah berfikir untuk bypass limitasi yang di lakukan oleh pihak Vendor / ISP kan? semisal Vendor / ISP kalian tidak bisa buka reddit, netplik, skidipapap huahuahua, dsb.","title":"Openvpn Multiple Port and Protocol"},{"content":"Â Â 1) Masalah Besar pada OpenVPN  Saat saya menginstall openvpn dari script automasi bang angristan (fork dari script Nyr), saya bisa setup server openvpn dengan cepat (hanya 5 menit) dan langsung work, tanpa harus setting cert, ip, routing dll secara manual\ntapi ada satu masalah yang sangat simple tetepi membahayakan, dimana saya tidak bisa akses server client yang terkonek dengan jaringan OpenVPN!!!!, semua service tidak bisa di akses, mulai dari ping, ssh, sftp, webserver, dll \u0026hellip; oke oke, jangan tenang tetap panik ğŸ˜\n masalah ini terjadi pada server yang melewatkan semua trafik nya melalui jaringan OpenVPN terlebih dahulu baru ke internet (redirect-gateway def1 bypass-dhcp)\n Â Â Â 2) Masalah Itu di Selesaikan, Bukan Di Hindari  Oke pertama kita lihat dimana masalah nya, kita analisa atu-atu, pokoknya pantang tidur sebelum solved ğŸ˜´, biar simple \u0026hellip; saya analisa trafik dari service webserver saja, untuk service lain (ssh, sftp, ftp dll) sama saja kok prinsip nya\nÂ 2.a) Alur Paket Web (Standar) pertama kita harus tahu bagaimana sebuah trafik / lalu lintas paket itu bekerja ketika kita mengakses sebuah website dari sudut pandang client / end-user\n+----------+ +------------+ +--------------+ | | | | | | | Client | +----\u0026gt; | Internet | +----\u0026gt; | Web Server | | | \u0026lt;----+ | | \u0026lt;----+ | | +----------+ +------------+ +--------------+ wewww, grafik yang sangat simpel bukan? saya kasih log web server nih, biar agak detail dikit ğŸ˜…\n180.254.92.138 - - [04/Jan/2021:09:57:29 +0000] \u0026#34;GET / HTTP/1.1\u0026#34; 200 612 \u0026#34;-\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0\u0026#34; \u0026#34;-\u0026#34; 180.254.92.138 - - [04/Jan/2021:09:57:30 +0000] \u0026#34;GET /favicon.ico HTTP/1.1\u0026#34; 404 153 \u0026#34;http://36.80.241.251/\u0026#34; \u0026#34;Mozilla/5.0 (X11; Linux x86_64; rv:84.0) Gecko/20100101 Firefox/84.0\u0026#34; \u0026#34;-\u0026#34; okehhh, perlu di inget dulu ye, ip public saya adalah 180.254.92.138 (sama seperti yang ada di log). Brati kalo saya simpulkan, cara kerja web server itu, dia akan mengembalikan request sesuai alamat ip client yang meminta.\nJadi semisal ip public saya 180.254.92.138 melakukan request ke google, ya google akan ngembaliin request ke ip public komputer saya, yaitu 180.254.92.138 \u0026hellip; bukannya ke ip 2.2.2.2 punyanya komputer pak RT ğŸ˜‚\nÂ 2.b) Alur Paket Web (OpenVPN) okeh bosq, sekarang kita uda tau bagaimana paket web standar itu bekerja, trus sekarang kita lihat trafik yang menggunakan OpenVPN kenapa tidak bekerja ğŸ˜¢\nmari kita lihat grafik nya\n+----------+ +------------+ +--------------+ | | | | | | | Client | +----\u0026gt; | Internet | +----\u0026gt; | Web Server | | | \u0026lt;----+ | | | | +----------+ +------+-----+ +--------------+ ^ | + +--------+---------+ | | | | | OpenVPN Server | \u0026lt;------------+ | | +------------------+ jika di lihat sekilas, seharusnya tidak ada masalah bukan? request dari client menuju web server, kemudian di kembalikan ke client, Normal and Simpel \u0026hellip; Hanya saja sebelum di kembalikan ke client, trafik di lewatkan ke jaringan OpenVPN terlebih dahulu\neits, tidak semudah itu ferguso \u0026hellip; kenyatannya trafik request dari client tidak sampai / balik lagi ke client alias PUTUS, trafik ini berlaku tidak hanya untuk service web, tapi semua service dari ssh, sftp, ftp dll\nÂ 2.c) Masalah nya tu disini \u0026hellip;. Intinya, saat client mengakses service (ping, ssh, web server, dll) di server yang semua traffik nya ter-redirect / dilewatkan ke OpenVPN, trafik tidak bisa kembali lagi ke client. Nah Loh ğŸ˜±\nDari pada vusing dan ngawang knape bisa gitu, mari kita analisis secara mendalam menggunakan wireshark-cli / tshark. Untuk mempermudah pengecekan, kita akan menggunakan protokol icmp / ping \u0026hellip; klo pake http ribet cyinn (ngelesss) ğŸ˜¬\ntapi sebelum itu, kita harus tahu trafik ping yang normal itu seperti apa\n\u0026gt; ping 1.1.1.1 PING 1.1.1.1 (1.1.1.1) 56(84) bytes of data. 64 bytes from 1.1.1.1: icmp_seq=1 ttl=55 time=29.6 ms 64 bytes from 1.1.1.1: icmp_seq=2 ttl=55 time=30.6 ms # wireshark-cli Capturing on \u0026#39;wlp9s0\u0026#39; 1 0.000000000 180.254.92.138 â†’ 1.1.1.1 ICMP 98 Echo (ping) request id=0x0016, seq=1/256, ttl=64 2 0.028321186 1.1.1.1 â†’ 180.254.92.138 ICMP 98 Echo (ping) reply id=0x0016, seq=1/256, ttl=55 (request in 1) 3 1.001599961 180.254.92.138 â†’ 1.1.1.1 ICMP 98 Echo (ping) request id=0x0016, seq=2/512, ttl=64 4 1.045006664 1.1.1.1 â†’ 180.254.92.138 ICMP 98 Echo (ping) reply id=0x0016, seq=2/512, ttl=55 (request in 3) okeh, traffik yang sangat sederhana, dimana saya sebagai client (180.254.92.138) melakukan ping (request) ke cloudflared (1.1.1.1) dan di balas dengan paket (reply)\nsekarang mari kita lihat trafik saat kita ping server yang semua traffic nya ter-redirect melewati OpenVPN\n\u0026gt; ping 1.1.1.1 PING 1.1.1.1 (1.1.1.1) 56(84) bytes of data. # wireshark-cli Capturing on \u0026#39;wlp9s0\u0026#39; 1 0.000000000 180.254.92.138 â†’ 114.xx.xx.21 ICMP 98 Echo (ping) request id=0x663a, seq=1/256, ttl=54 2 1.169998179 180.254.92.138 â†’ 114.xx.xx.21 ICMP 98 Echo (ping) request id=0x663a, seq=2/512, ttl=54 3 2.036470879 180.254.92.138 â†’ 114.xx.xx.21 ICMP 98 Echo (ping) request id=0x663a, seq=3/768, ttl=54 loh loh, kok command ping nya stcuk dan paket nya request saja? tidak ada balasan / reply? seperti cinta bertepuk sebelah tangan bukan? ğŸ˜›\nÂ Â Â 3) Menyelesaikan Masalah Tanpa Solusi  setelah mencari wangsit dari sabang sampai merauke, akhirnya saya dapat akar masalahnya ğŸ˜‚ .. sebelum itu mari kita lihat grafik trafik sekali lagi\n+----------+ +------------+ +--------------+ | | | | | | | Client | +----\u0026gt; | Internet | +----\u0026gt; | Web Server | | | \u0026lt;----+ | | | | +----------+ +------+-----+ +--------------+ ^ | + +--------+---------+ | | | | | OpenVPN Server | \u0026lt;------------+ | | +------------------+ jika kita amati di Web Server, kita bisa lihat bahwa jalur trafik masuk dan keluar itu berbeda bukan? katakanlah masuk lewat pintu depan dan keluar lewat jendela\nperlu di ingat bahwa komputer hanya malayani trafik default, di mana trafik masuk dan keluar lewat pintu depan \u0026hellip; Tapi jangan putus asa dulu, mau tahu cara solved nya? jangan kasi kendor, baca terus sampai bawah ğŸ˜Š\nÂ 3.a) Skenario 1 sebelum mulai, kita lihat gambaran skema trafik flow dari skenario 1 ini\n+----------+ +------------+ +--------------+ | | | | | | | Client | +----\u0026gt; | Internet | +----\u0026gt; | Web Server | | | \u0026lt;----+ | | \u0026lt;----+ | | +----------+ +------+-----+ +--------------+ ^ | + +--------+---------+ | | | | | OpenVPN Server | \u0026lt;------------+ | | +------------------+ secara garis besar tidak ada perubahan, tetapiiii jika kita perhatikan di Web Server, ada panah bolak-balik yang menandakan, trafik client yang masuk pintu depan, akan kita balikkan ke pintu depan lagi dari pada kita redirect / alihkan melalui jendala (OpenVPN)\ntraffic di atas bisa di lakukan dengan routing ke arah ip public client yang mengakses server\n\u0026gt; ip route add \u0026lt; ip public client \u0026gt; dev \u0026lt; interface WAN server \u0026gt; # Contoh \u0026gt; ip route add 1.1.1.1 dev eth0  kekurangan dari solusi ini adalah kita harus routing satu2 public ip client yang ingin terhubung / akses ke server\n Â 3.b) Skenario 2 skenarion ke 2 ini akan tetap mempertahankan skema awal trafic, dimana trafik masuk dari pintu depan (eth0 WAN Internet) dan keluar melalui jendela (tun0 - OpenVPN) dengan menggunakan chain filter dan nat masqurade. Untuk skema trafik nya seperti di bawah ini\n+----------+ +------------+ +--------------+ | | | | | | | Client | +----\u0026gt; | Internet | +----\u0026gt; | Web Server | | | \u0026lt;----+ | | | | +----------+ +------+-----+ +--------------+ ^ | + +--------+---------+ | | | | | OpenVPN Server | \u0026lt;------------+ | | +------------------+ semua bisa di lakukan dengan cara\n# ipv4 forward \u0026gt; sysctl -w net.ipv4.ip_forward=1 # accept forward chain \u0026gt; iptables -A FORWARD --in-interface eth0 -j ACCEPT # masking ip (NAT) after routing process \u0026gt; iptables --table nat -A POSTROUTING --out-interface tun0 -j MASQUERADE  kekurangan dari solusi ini adalah, tidak semua service akan berhasil. karena akan di anggap sebagai serangan MITM / spoofing. dimana kita meminta (request) ke server ip 1.1.1.1 tapi yang membalas (reply) adalah server ip 5.5.5.5\n Â 3.c) Skenario 3 ada 2 skenario terakhir dan ini solusi yang recommended menurut saya, yaitu\n Pertama, non-aktifkan redirecting all traffic  berguna agar tidak semua traffic di lewatkan OpenVPN, hanya network ip tertentu saja yang di lewatkan. Delete / Comment baris seperti di bawah    # redirect-gateway def1 bypass-dhcp  Kedua, jika ingin tetap melewatkan semua trafic melewati jaringan OpenVPN, gunakan fitur packet marking yang ada di iptables\n rule ini berfungsi untuk menandai setiap packet yang masuk ke server. Yang mana nantinya packet response akan melewati jalan di mana packet tersebut masuk.  sebagai contoh, jika kita masuk lewat pintu depan, maka saat kita keluar, server akan mengarahkan lewat pintu depan juga, tidak lewat jendela seperti sebelumnya\n  untuk point 2 explore sendiri yeee, ribet cyin soalnyeee \u0026hellip; nih link nya ğŸ˜‚\n","permalink":"https://berrabe.github.io/id/posts/2021/01-jan-2021/openvpn-redirect-problem/","summary":"1) Masalah Besar pada OpenVPN  Saat saya menginstall openvpn dari script automasi bang angristan (fork dari script Nyr), saya bisa setup server openvpn dengan cepat (hanya 5 menit) dan langsung work, tanpa harus setting cert, ip, routing dll secara manual\ntapi ada satu masalah yang sangat simple tetepi membahayakan, dimana saya tidak bisa akses server client yang terkonek dengan jaringan OpenVPN!!!!, semua service tidak bisa di akses, mulai dari ping, ssh, sftp, webserver, dll \u0026hellip; oke oke, jangan tenang tetap panik ğŸ˜","title":"Openvpn Redirect Problem"},{"content":"","permalink":"https://berrabe.github.io/id/archives/","summary":"archives","title":"Archive"},{"content":"","permalink":"https://berrabe.github.io/id/search/","summary":"","title":"Pencarian"}]